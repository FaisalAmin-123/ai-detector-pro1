<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Content Detector Pro ‚Äî Advanced Edition</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --primary: #6366f1;
      --primary-dark: #4f46e5;
      --secondary: #06b6d4;
      --success: #10b981;
      --danger: #ef4444;
      --bg-dark: #0f172a;
      --bg-card: #1e293b;
      --bg-elevated: #334155;
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
      --border: #334155;
    }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.6;
    }

    /* Modern gradient background */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background: 
        radial-gradient(circle at 20% 20%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
      position: relative;
      z-index: 1;
    }

    /* Header */
    header {
      text-align: center;
      margin-bottom: 3rem;
      animation: fadeIn 0.6s ease;
    }

    .logo {
      display: inline-flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .logo-icon {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      font-weight: 900;
      box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 800;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 0.5rem;
    }

    .subtitle {
      color: var(--text-secondary);
      font-size: 1.1rem;
    }

    .badge {
      display: inline-block;
      padding: 0.4rem 1rem;
      background: rgba(99, 102, 241, 0.1);
      border: 1px solid rgba(99, 102, 241, 0.3);
      border-radius: 999px;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--primary);
      margin-top: 1rem;
    }

    /* Main Card */
    .card {
      background: var(--bg-card);
      border-radius: 24px;
      padding: 2.5rem;
      border: 1px solid var(--border);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: slideUp 0.6s ease;
    }

    /* Input Section */
    .input-section {
      position: relative;
    }

    label {
      display: block;
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 0.75rem;
    }

    textarea {
      width: 100%;
      min-height: 180px;
      padding: 1.25rem;
      background: var(--bg-dark);
      border: 2px solid var(--border);
      border-radius: 16px;
      color: var(--text-primary);
      font-size: 1rem;
      font-family: inherit;
      resize: vertical;
      transition: all 0.3s ease;
      outline: none;
    }

    textarea:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
    }

    textarea::placeholder {
      color: var(--text-secondary);
      opacity: 0.5;
    }

    /* Buttons */
    .button-group {
      display: flex;
      gap: 1rem;
      margin-top: 1.5rem;
      flex-wrap: wrap;
    }

    button {
      padding: 0.875rem 1.75rem;
      border: none;
      border-radius: 12px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-family: inherit;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
    }

    .btn-secondary {
      background: var(--bg-elevated);
      color: var(--text-primary);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      background: var(--border);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }

    /* File Upload */
    .file-upload {
      margin-top: 1.5rem;
      padding: 1.5rem;
      background: var(--bg-dark);
      border: 2px dashed var(--border);
      border-radius: 16px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .file-upload:hover {
      border-color: var(--primary);
      background: rgba(99, 102, 241, 0.05);
    }

    input[type="file"] {
      display: none;
    }

    .file-label {
      cursor: pointer;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    /* Results Section */
    .results {
      margin-top: 2rem;
      display: none;
      animation: fadeIn 0.6s ease;
    }

    .results.show {
      display: block;
    }

    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .prediction-box {
      padding: 2rem;
      border-radius: 16px;
      text-align: center;
      margin-bottom: 1.5rem;
      animation: scaleIn 0.4s ease;
    }

    .prediction-box.ai {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.1));
      border: 2px solid rgba(239, 68, 68, 0.3);
    }

    .prediction-box.human {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1));
      border: 2px solid rgba(16, 185, 129, 0.3);
    }

    .prediction-label {
      font-size: 0.85rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
    }

    .prediction-value {
      font-size: 2.5rem;
      font-weight: 900;
      margin-bottom: 0.5rem;
    }

    .prediction-box.ai .prediction-value {
      color: var(--danger);
    }

    .prediction-box.human .prediction-value {
      color: var(--success);
    }

    .confidence-bar {
      width: 100%;
      height: 12px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 999px;
      overflow: hidden;
      margin-top: 1rem;
    }

    .confidence-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--success), var(--secondary));
      border-radius: 999px;
      transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 0.5rem;
      font-size: 0.7rem;
      font-weight: 700;
      color: white;
    }

    /* Detailed View Toggle */
    .toggle-detailed {
      margin: 1.5rem 0;
      padding: 1rem;
      background: var(--bg-dark);
      border-radius: 12px;
      border: 1px solid var(--border);
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .toggle-detailed:hover {
      background: var(--bg-elevated);
    }

    .toggle-detailed .icon {
      transition: transform 0.3s ease;
    }

    .toggle-detailed.active .icon {
      transform: rotate(180deg);
    }

    /* Detailed Analysis */
    .detailed-analysis {
      display: none;
      animation: slideDown 0.4s ease;
    }

    .detailed-analysis.show {
      display: block;
    }

    .method-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .method-card {
      padding: 1.25rem;
      background: var(--bg-dark);
      border-radius: 12px;
      border: 1px solid var(--border);
    }

    .method-title {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .method-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .method-desc {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    /* Advanced Features */
    .advanced-section {
      margin-top: 1.5rem;
      padding: 1.5rem;
      background: rgba(99, 102, 241, 0.05);
      border-radius: 12px;
      border: 1px solid rgba(99, 102, 241, 0.2);
    }

    .section-title {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .feature-list {
      display: grid;
      gap: 0.75rem;
    }

    .feature-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem;
      background: var(--bg-card);
      border-radius: 8px;
      font-size: 0.9rem;
    }

    .feature-name {
      color: var(--text-secondary);
      font-weight: 500;
    }

    .feature-value {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
    }

    .status-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 700;
    }

    .status-badge.ai {
      background: rgba(239, 68, 68, 0.15);
      color: var(--danger);
    }

    .status-badge.human {
      background: rgba(16, 185, 129, 0.15);
      color: var(--success);
    }

    /* Loading State */
    .loading {
      position: absolute;
      inset: 0;
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(4px);
      display: none;
      align-items: center;
      justify-content: center;
      border-radius: 24px;
      z-index: 10;
    }

    .loading.show {
      display: flex;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* Error Message */
    .error {
      display: none;
      padding: 1rem;
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 12px;
      color: var(--danger);
      margin-top: 1rem;
      font-size: 0.9rem;
    }

    .error.show {
      display: block;
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes slideDown {
      from { opacity: 0; max-height: 0; }
      to { opacity: 1; max-height: 2000px; }
    }

    @keyframes scaleIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .container {
        padding: 1rem;
      }

      h1 {
        font-size: 1.75rem;
      }

      .card {
        padding: 1.5rem;
      }

      .method-grid {
        grid-template-columns: 1fr;
      }

      .button-group {
        flex-direction: column;
      }

      button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <div class="logo-icon">AI</div>
      </div>
      <h1>AI Content Detector Pro</h1>
      <p class="subtitle">Advanced Edition ‚Ä¢ 13 Detection Methods</p>
      <span class="badge">üî¨ Powered by Machine Learning + Statistical Analysis</span>
    </header>

    <div class="card">
      <div class="input-section">
        <div class="loading" id="loading">
          <div style="text-align: center;">
            <div class="spinner"></div>
            <div style="margin-top: 1rem; color: var(--text-primary); font-weight: 600;">
              Analyzing with 13 methods...
            </div>
          </div>
        </div>

        <label for="textInput">
          Enter or paste text to analyze
          <span style="float: right; color: var(--text-secondary);" id="charCount">0 characters</span>
        </label>
        
        <textarea 
          id="textInput" 
          placeholder="Paste your text here (minimum 20 characters)..."
        ></textarea>

        <div class="button-group">
          <button class="btn-primary" id="analyzeBtn">
            <span>üîç</span> Analyze Text
          </button>
          <button class="btn-secondary" id="clearBtn">
            <span>üóë</span> Clear
          </button>
          <button class="btn-secondary" id="exampleAI">
            Try AI Sample
          </button>
          <button class="btn-secondary" id="exampleHuman">
            Try Human Sample
          </button>
        </div>

        <div class="file-upload">
          <input type="file" id="fileInput" accept=".pdf,.png,.jpg,.jpeg,.txt">
          <label for="fileInput" class="file-label">
            üìé Or drag & drop a file (PDF, Image, Text)
          </label>
        </div>

        <div class="error" id="error"></div>
      </div>

      <!-- Results Section -->
      <div class="results" id="results">
        <div class="result-header">
          <h2 style="font-size: 1.5rem; font-weight: 700;">Analysis Results</h2>
        </div>

        <!-- Main Result -->
        <div class="prediction-box" id="predictionBox">
          <div class="prediction-label">Final Prediction</div>
          <div class="prediction-value" id="predictionValue">‚Äî</div>
          <div style="font-size: 0.9rem; color: var(--text-secondary);" id="agreement">‚Äî</div>
          <div class="confidence-bar">
            <div class="confidence-fill" id="confidenceFill" style="width: 0%">0%</div>
          </div>
        </div>

        <!-- Toggle Detailed View -->
        <div class="toggle-detailed" id="toggleDetailed">
          <div>
            <strong>View Detailed Analysis</strong>
            <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">
              See results from all 13 detection methods
            </div>
          </div>
          <div class="icon">‚ñº</div>
        </div>

        <!-- Detailed Analysis -->
        <div class="detailed-analysis" id="detailedAnalysis">
          <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem;">Core Detection Methods</h3>
          
          <div class="method-grid">
            <div class="method-card">
              <div class="method-title">ü§ñ Machine Learning</div>
              <div class="method-value" id="mlValue">‚Äî</div>
              <div class="method-desc" id="mlDesc">‚Äî</div>
            </div>

            <div class="method-card">
              <div class="method-title">üìà Perplexity Analysis</div>
              <div class="method-value" id="perpValue">‚Äî</div>
              <div class="method-desc" id="perpDesc">‚Äî</div>
            </div>

            <div class="method-card">
              <div class="method-title">üìä Burstiness Analysis</div>
              <div class="method-value" id="burstValue">‚Äî</div>
              <div class="method-desc" id="burstDesc">‚Äî</div>
            </div>
          </div>

          <!-- Advanced Features -->
          <div class="advanced-section">
            <div class="section-title">üî¨ Advanced Statistical Features</div>
            <div style="margin-bottom: 1rem;">
              <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                Overall AI Score
              </div>
              <div style="font-size: 2rem; font-weight: 800;" id="advancedScore">‚Äî</div>
              <div style="font-size: 0.85rem; color: var(--text-secondary);" id="advancedInterp">‚Äî</div>
            </div>

            <div class="feature-list" id="featureList">
              <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                Advanced features will appear here after analysis
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const API_URL = window.location.hostname === 'localhost' 
    ? 'http://localhost:5000'
    : 'https://ai-detector-pro.onrender.com';

    const examples = {
      ai: "Machine learning algorithms have revolutionized artificial intelligence. These sophisticated systems demonstrate remarkable capabilities in data processing and pattern recognition. The implementation of neural networks enables advanced computational functionality across many domains. Modern AI continues to evolve with unprecedented sophistication.",
      human: "omg you won't believe what happened today!! so i was literally just sitting there and this random guy spills coffee on my laptop. like seriously?? i was so mad lol but he apologized and offered to buy me a new one. anyway how's your day been? mine's been absolutely crazy haha"
    };

    // Elements
    const textInput = document.getElementById('textInput');
    const charCount = document.getElementById('charCount');
    const analyzeBtn = document.getElementById('analyzeBtn');
    const clearBtn = document.getElementById('clearBtn');
    const loading = document.getElementById('loading');
    const error = document.getElementById('error');
    const results = document.getElementById('results');
    const toggleDetailed = document.getElementById('toggleDetailed');
    const detailedAnalysis = document.getElementById('detailedAnalysis');
    const fileInput = document.getElementById('fileInput');

    // Event Listeners
    textInput.addEventListener('input', updateCharCount);
    analyzeBtn.addEventListener('click', analyze);
    clearBtn.addEventListener('click', clear);
    document.getElementById('exampleAI').addEventListener('click', () => loadExample('ai'));
    document.getElementById('exampleHuman').addEventListener('click', () => loadExample('human'));
    toggleDetailed.addEventListener('click', toggleDetailedView);
    fileInput.addEventListener('change', handleFileUpload);

    function updateCharCount() {
      charCount.textContent = textInput.value.length + ' characters';
    }

    function loadExample(type) {
      textInput.value = examples[type];
      updateCharCount();
    }

    function clear() {
      textInput.value = '';
      updateCharCount();
      results.classList.remove('show');
      error.classList.remove('show');
    }

    function toggleDetailedView() {
      detailedAnalysis.classList.toggle('show');
      toggleDetailed.classList.toggle('active');
    }

    function showError(msg) {
      error.textContent = msg;
      error.classList.add('show');
      setTimeout(() => error.classList.remove('show'), 5000);
    }

    function setLoading(show) {
      loading.classList.toggle('show', show);
      analyzeBtn.disabled = show;
    }

    async function analyze() {
      const text = textInput.value.trim();
      
      if (!text || text.length < 20) {
        showError('Please enter at least 20 characters');
        return;
      }

      error.classList.remove('show');
      setLoading(true);

      try {
        const response = await fetch(API_URL + '/analyze/detailed', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ text })
        });

        if (!response.ok) throw new Error('Analysis failed');

        const data = await response.json();
        console.log('API Response:', data);
        displayResults(data);
      } catch (err) {
        console.error(err);
        showError('Cannot connect to API. Make sure the backend is running on port 5000.');
      } finally {
        setLoading(false);
      }
    }

    async function handleFileUpload() {
      const file = fileInput.files[0];
      if (!file) return;

      setLoading(true);
      const formData = new FormData();
      formData.append('file', file);

      try {
        const response = await fetch(API_URL + '/analyze/file', {
          method: 'POST',
          body: formData
        });

        if (!response.ok) throw new Error('Upload failed');

        const data = await response.json();
        displayResults(data);
      } catch (err) {
        showError('File upload failed: ' + err.message);
      } finally {
        setLoading(false);
      }
    }

    function displayResults(data) {
      results.classList.add('show');

      // Get values safely
      const isAI = data.final_decision?.is_ai_generated || false;
      const label = data.final_decision?.label || 'Unknown';
      const confidence = data.final_decision?.confidence || 0;
      const agreement = data.agreement?.agreement_level || '';

      // Update prediction box
      const predBox = document.getElementById('predictionBox');
      predBox.className = 'prediction-box ' + (isAI ? 'ai' : 'human');
      document.getElementById('predictionValue').textContent = label;
      document.getElementById('agreement').textContent = agreement;

      // Update confidence bar
      const confFill = document.getElementById('confidenceFill');
      confFill.style.width = confidence + '%';
      confFill.textContent = confidence.toFixed(1) + '%';

      // Core methods
      if (data.methods) {
        const ml = data.methods.ml_detection || {};
        const perp = data.methods.perplexity_analysis || {};
        const burst = data.methods.burstiness_analysis || {};

        // ML
        document.getElementById('mlValue').textContent = ml.label || 'N/A';
        document.getElementById('mlDesc').textContent = 
          ml.confidence ? `${ml.confidence.toFixed(1)}% confidence` : '';

        // Perplexity
        document.getElementById('perpValue').textContent = 
          perp.score ? perp.score.toFixed(2) : 'N/A';
        document.getElementById('perpDesc').textContent = perp.interpretation || '';

        // Burstiness
        const burstScore = burst.burstiness_score || burst.score || 0;
        document.getElementById('burstValue').textContent = burstScore.toFixed(2);
        document.getElementById('burstDesc').textContent = burst.interpretation || '';

        // Advanced Features
        const adv = data.methods.advanced_features;
        if (adv && !adv.error) {
          document.getElementById('advancedScore').textContent = 
            adv.overall_score?.toFixed(1) + '%' || 'N/A';
          document.getElementById('advancedInterp').textContent = 
            adv.interpretation || '';

          // Feature list
          const features = adv.features || {};
          let html = '';

          const featureMap = [
            { key: 'token_entropy', name: 'Token Entropy', format: (f) => f.score?.toFixed(2) },
            { key: 'ttr', name: 'Type-Token Ratio', format: (f) => f.percentage?.toFixed(1) + '%' },
            { key: 'hapax_ratio', name: 'Hapax Legomena', format: (f) => f.percentage?.toFixed(1) + '%' },
            { key: 'lexical_diversity', name: 'Lexical Diversity', format: (f) => (f.percentage || f.mattr * 100 || 0).toFixed(1) + '%' },
            { key: 'function_word_freq', name: 'Function Words', format: (f) => f.percentage?.toFixed(1) + '%' },
            { key: 'avg_word_length', name: 'Avg Word Length', format: (f) => f.score?.toFixed(2) },
            { key: 'punctuation_density', name: 'Punctuation Density', format: (f) => f.score?.toFixed(3) },
            { key: 'capitalization_ratio', name: 'Capitalization', format: (f) => f.percentage?.toFixed(1) + '%' },
            { key: 'repetition_score', name: 'Repetition', format: (f) => f.score?.toFixed(3) }
          ];

          featureMap.forEach(({ key, name, format }) => {
            const feature = features[key];
            if (feature && !feature.error) {
              const value = format(feature);
              const isAI = feature.is_ai_likely;
              const badge = isAI !== undefined ? 
                `<span class="status-badge ${isAI ? 'ai' : 'human'}">${isAI ? 'AI' : 'Human'}</span>` : '';
              
              html += `
                <div class="feature-item">
                  <span class="feature-name">${name}</span>
                  <span class="feature-value">${value} ${badge}</span>
                </div>
              `;
            }
          });

          document.getElementById('featureList').innerHTML = html || 
            '<div style="text-align: center; padding: 1rem; color: var(--text-secondary);">No advanced features data available</div>';
        }
      }
    }
  </script>
</body>
</html>